<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±—é–¥–∂–µ—Ç–∞</title>
    <link rel="stylesheet" href="style.css">
  </head>
  
  <body>

    <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±—é–¥–∂–µ—Ç–∞</h1>
  
    <p style="text-align:center; margin-bottom: 20px;">
      <a href="stats.html" style="text-decoration: none; background: #333; color: white; padding: 10px 20px; border-radius: 6px;">üìä –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</a>
    </p>

    <div class="balance">
      –ë–∞–ª–∞–Ω—Å: <span id="balance">0 ‚ÇΩ</span>
    </div>

    <form id="transaction-form">
      <input type="text" id="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" required />
      <input type="number" id="amount" placeholder="–°—É–º–º–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: -500 –∏–ª–∏ 1200)" required />
      
      <select id="type">
        <option value="income">–î–æ—Ö–æ–¥</option>
        <option value="expense">–†–∞—Å—Ö–æ–¥</option>
      </select>

      <select id="category">
        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –º–µ–Ω—è—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ -->
      </select>

      <!-- –ü–æ–ª–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã -->
      <input type="date" id="date" required />

      <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
    </form>

    <h2>–û–ø–µ—Ä–∞—Ü–∏–∏</h2>
    <ul id="transaction-list"></ul>

    <script>
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª—è —Å –¥–∞—Ç–æ–π —Ç–µ–∫—É—â–µ–π –¥–∞—Ç–æ–π
      document.addEventListener('DOMContentLoaded', () => {
        const dateInput = document.getElementById('date');
        const today = new Date();
        const formattedDate = today.toISOString().split('T')[0];
        dateInput.value = formattedDate;
      });

      const form = document.getElementById('transaction-form');
      const list = document.getElementById('transaction-list');
      const balanceEl = document.getElementById('balance');

      let transactions = JSON.parse(localStorage.getItem('transactions')) || [];

      const typeSelect = document.getElementById('type');
      const categorySelect = document.getElementById('category');

      function updateCategories() {
        categorySelect.innerHTML = '';
        if (typeSelect.value === 'income') {
          const incomeCategories = ['–ó–∞—Ä–ø–ª–∞—Ç–∞', '–î—Ä—É–≥–æ–µ'];
          incomeCategories.forEach(cat => {
            const option = document.createElement('option');
            option.value = cat;
            option.textContent = cat;
            categorySelect.appendChild(option);
          });
        } else if (typeSelect.value === 'expense') {
          const expenseCategories = ['–ï–¥–∞', '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è', '–ü–æ–∫—É–ø–∫–∏', '–î—Ä—É–≥–æ–µ'];
          expenseCategories.forEach(cat => {
            const option = document.createElement('option');
            option.value = cat;
            option.textContent = cat;
            categorySelect.appendChild(option);
          });
        }
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
      updateCategories();
      
      typeSelect.addEventListener('change', updateCategories);

      function updateBalance() {
        const balance = transactions.reduce((sum, t) => sum + t.amount, 0);
        balanceEl.textContent = `${balance.toLocaleString()} ‚ÇΩ`;
      }

      function renderTransactions() {
        list.innerHTML = '';
        transactions.forEach((t, index) => {
          const li = document.createElement('li');
          li.classList.add(t.amount >= 0 ? 'income' : 'expense');
          li.innerHTML = `
            <strong>${t.description}</strong><br>
            <small>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${t.category || '‚Äî'}</small><br>
            <small>–î–∞—Ç–∞: ${t.date || '‚Äî'}</small><br>
            <span>${t.amount >= 0 ? '+' : ''}${t.amount} ‚ÇΩ</span>
            <button onclick="removeTransaction(${index})" style="float:right;">√ó</button>
          `;
          list.appendChild(li);
        });
      }

      function addTransaction(e) {
        e.preventDefault();
        const desc = document.getElementById('description').value;
        const amountInput = +document.getElementById('amount').value;
        const type = document.getElementById('type').value;
        const category = document.getElementById('category').value;
        const date = document.getElementById('date').value;

        const amount = type === 'expense' ? -Math.abs(amountInput) : Math.abs(amountInput);

        transactions.push({ description: desc, amount, category, date });

        localStorage.setItem('transactions', JSON.stringify(transactions));
        form.reset();
        updateBalance();
        renderTransactions();
      }

      function removeTransaction(index) {
        transactions.splice(index, 1);
        localStorage.setItem('transactions', JSON.stringify(transactions));
        updateBalance();
        renderTransactions();
      }

      form.addEventListener('submit', addTransaction);

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
      updateBalance();
      renderTransactions();
    </script>
  </body>
</html>
